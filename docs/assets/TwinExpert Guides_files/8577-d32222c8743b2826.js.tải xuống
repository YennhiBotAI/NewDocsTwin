"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8577],{78577:(e,t,a)=>{a.d(t,{PlanProvider:()=>o,Jz:()=>u,jI:()=>c,G5:()=>p,ci:()=>m});var r=a(58081),s=a(82149);class i{async fetchWithCache(e){let t=this.cache.get(e);if(t&&Date.now()-t.timestamp<this.cacheTimeout)return t.data;try{let t=await fetch("".concat(this.baseUrl,"/plan-constants").concat(e));if(!t.ok)throw Error("Failed to fetch plan constants: ".concat(t.statusText));let a=await t.json();if(!a.success)throw Error("API returned unsuccessful response");return this.cache.set(e,{data:a.data,timestamp:Date.now()}),a.data}catch(a){if(console.error("Error fetching plan constants from ".concat(e,":"),a),t)return console.warn("Using expired cache due to API error"),t.data;return this.getFallbackData(e)}}getFallbackData(e){return({"/types":{FREE:"free",CREATOR:"creator",PRO:"pro",BUSINESS:"business"},"/options":[{type:"free",name:"Free",displayName:"Free Plan",description:"Perfect for individual users to explore AI Twins",dailyLimit:10,monthlyLimit:300,maxProjects:1,maxFilesPerProject:5,fileSizeLimit:2,teamMembers:1,fileLimit:5,maxTeamMembers:1,maxFileUploadsPerMonth:5,maxFileSizeMB:2,features:["Basic AI Twin access","1 project, 5 files/project (2MB max)","Basic notes","Single user"],price:"$0",color:"gray"}],"/limits":{free:{dailyMessageLimit:10,monthlyMessageLimit:300,maxProjects:1,maxFilesPerProject:5,maxFileSizeMB:2,teamMemberLimit:1,monthlyFileLimit:5}}})[e]||{}}async getAllPlanData(){return this.fetchWithCache("")}async getPlanTypes(){return(await this.getAllPlanData()).planTypes}async getPlanLimits(){return(await this.getAllPlanData()).planLimits}async getSubscriptionStatus(){return(await this.getAllPlanData()).subscriptionStatus}async getPlanOptions(){return(await this.getAllPlanData()).planOptions}async getPlanLimitsByType(e){return this.fetchWithCache("/limits/".concat(e))}clearCache(){this.cache.clear()}async getPlanOption(e){return(await this.getPlanOptions()).find(t=>t.type===e)}async getPlanColor(e){let t=await this.getPlanOption(e);return(null==t?void 0:t.color)||"gray"}async formatFileLimit(e){return -1===e?"Unlimited":"".concat(e," files")}async formatTeamMembers(e){return 1===e?"1 member":"".concat(e," members")}constructor(){this.cache=new Map,this.cacheTimeout=3e5,this.baseUrl="https://api.twinexpert.com"}}let n=new i,l=(0,s.createContext)(void 0);function o(e){let{children:t}=e,[a,i]=(0,s.useState)(null),[o,c]=(0,s.useState)(!0),[u,p]=(0,s.useState)(null),m=async()=>{try{c(!0),p(null);let e=await n.getAllPlanData();i(e)}catch(e){p(e instanceof Error?e.message:"Failed to fetch plan data"),console.error("Error fetching plan data:",e)}finally{c(!1)}};(0,s.useEffect)(()=>{m()},[]);let d=e=>a?e?a.planLimits[e]||a.planLimits.free:a.planLimits:{},h=()=>(null==a?void 0:a.planOptions)||[],v=e=>h().find(t=>t.type===e),P=e=>null==a?void 0:a.planCapabilities[e],f=e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsApiKeys)||!1},y=e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.canCreateProjects)||!1},g=e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.canCreateTeams)||!1},F=e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.canInviteMembers)||!1},S=e=>null==a?void 0:a.roleCapabilities[e],b=e=>(0,s.useMemo)(()=>{if(!a)return{canUseAI:!1,canUseSmartSearch:!1,canProcessFiles:!1,maxFiles:5,maxFileSize:2,features:[]};let t=v(e),r=d(e),s=P(e);if(!t||!r||!s){let e=d("free");return{canUseAI:!1,canUseSmartSearch:!1,canProcessFiles:!1,maxFiles:e.maxFilesPerProject||5,maxFileSize:e.maxFileSizeMB||2,features:[]}}let i=[];return s.supportsAIFeatures&&i.push("ai_processing"),s.supportsSemanticSearch&&i.push("smart_search"),s.supportsPriorityProcessing&&i.push("priority_processing"),s.supportsCustomAnalysis&&i.push("custom_analysis"),{canUseAI:s.supportsAIFeatures||!1,canUseSmartSearch:s.supportsSemanticSearch||!1,canProcessFiles:r.maxFilesPerProject>0,maxFiles:r.maxFilesPerProject||0,maxFileSize:r.maxFileSizeMB||0,features:i}},[e,a]);return(0,r.jsx)(l.Provider,{value:{planData:a,loading:o,error:u,refetch:m,getPlanTypes:()=>(null==a?void 0:a.planTypes)||{},getPlanLimits:d,getPlanOptions:h,getPlanOption:v,getPlanColor:e=>{let t=v(e);return(null==t?void 0:t.color)||"gray"},getSubscriptionStatus:()=>(null==a?void 0:a.subscriptionStatus)||{},canUseApiKeys:e=>f(e),formatFileLimit:e=>-1===e?"Unlimited":"".concat(e," files"),formatTeamMembers:e=>1===e?"1 member":"".concat(e," members"),isValidPlanType:e=>Object.keys((null==a?void 0:a.planTypes)||{}).includes(e),supportsApiKeys:f,supportsTeamFeatures:e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsTeamFeatures)||!1},supportsPremiumFeatures:e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsPremiumFeatures)||!1},supportsAdvancedFeatures:e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsAdvancedFeatures)||!1},supportsAIFeatures:e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsAIFeatures)||!1},supportsSemanticSearch:e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsSemanticSearch)||!1},supportsPriorityProcessing:e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsPriorityProcessing)||!1},supportsCustomAnalysis:e=>{var t;return(null===(t=P(e))||void 0===t?void 0:t.supportsCustomAnalysis)||!1},canCreateProjects:y,canCreateTeams:g,canInviteMembers:F,getPlanCapabilities:P,getRoleCapabilities:S,canUserCreateProjects:(e,t)=>{var a;let r=y(e),s=(null===(a=S(t))||void 0===a?void 0:a.canCreateProjectsWithRole)||!1;return r&&s},canUserInviteMembers:(e,t)=>{var a;let r=F(e),s=(null===(a=S(t))||void 0===a?void 0:a.canInviteMembersWithRole)||!1;return r&&s},canUserManageTeam:(e,t)=>{var a;let r=g(e),s=(null===(a=S(t))||void 0===a?void 0:a.canManageTeam)||!1;return r&&s},useProjectFeatures:b,hasFeatureAccess:(e,t)=>b(t).features.includes(e),getUpgradeLevel:e=>{var t;if(!a)return null;let r=h(),s=r.findIndex(t=>t.type.toLowerCase()===(null==e?void 0:e.toLowerCase()));return -1===s||s===r.length-1?null:(null===(t=r[s+1])||void 0===t?void 0:t.type)||null},getPlanDisplayName:e=>{if(!a)return e||"Free";let t=v(e);return(null==t?void 0:t.name)||e||"Free"}},children:t})}function c(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("usePlan must be used within a PlanProvider");return e}function u(e){let{canUseApiKeys:t}=c();return t(e)}function p(e){let{getPlanOption:t}=c();return t(e)}function m(e){let{useProjectFeatures:t}=c();return t(e)}}}]);