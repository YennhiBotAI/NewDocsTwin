(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{6146:()=>{},8933:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>d});var r=a(58081),s=a(82149),i=a(83551);function d(e){let{children:t}=e,a=(0,s.useRef)(null);return(0,s.useEffect)(()=>(a.current=(0,i.Ph)()||null,()=>{a.current&&a.current()}),[]),(0,r.jsx)(r.Fragment,{children:t})}},31240:(e,t,a)=>{"use strict";a.d(t,{J:()=>p,UserProvider:()=>m});var r=a(58081),s=a(82149),i=a(25027),d=a(55844),n=a(19651),o=a(83551),l=a(43851),c=a(27071);let u=(0,s.createContext)(void 0),f={admin:["create_twin","edit_twin","delete_twin","view_all_twins","manage_settings","view_conversations","manage_users"],user:["view_accessible_twins","chat_with_twins"]};function m(e){let{children:t}=e,[a,m]=(0,s.useState)(null),[p,h]=(0,s.useState)(!0),{toast:b}=(0,d.dj)(),g=(0,n.useRouter)(),v=(0,n.usePathname)(),x=l.Ff.some(e=>"/"===e?"/"===v:v.startsWith(e)),w=async()=>{if(x){h(!1);return}try{let e=await (0,i.KU)(g,{skipRedirect:x,requireAuth:!x}),t=await e.getCurrentUser();(0,c.NG)((null==t?void 0:t.id)||null),m(t)}catch(e){console.log("Failed to get user data:",e),m(null),(0,c.NG)(null)}finally{h(!1)}};return(0,s.useEffect)(()=>{(0,c.Ke)();let e=(0,o.Bh)(async(e,t)=>{"SIGNED_IN"===e||"TOKEN_REFRESHED"===e?x||await w():"SIGNED_OUT"===e&&(m(null),h(!1),(0,c.g0)())});return w(),e},[v,x]),(0,r.jsx)(u.Provider,{value:{user:a,isLoading:p,hasPermission:e=>{var t;return!!a&&("admin"===a.role||(null===(t=f[a.role])||void 0===t?void 0:t.includes(e)))},refreshUser:w},children:t})}function p(){let e=(0,s.useContext)(u);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},34726:(e,t,a)=>{"use strict";a.d(t,{Toaster:()=>g});var r=a(58081),s=a(55844),i=a(82149),d=a(94680),n=a(23484),o=a(22522),l=a(87687);let c=d.Kq,u=i.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(d.LM,{ref:t,className:(0,l.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...s})});u.displayName=d.LM.displayName;let f=(0,n.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),m=i.forwardRef((e,t)=>{let{className:a,variant:s,...i}=e;return(0,r.jsx)(d.bL,{ref:t,className:(0,l.cn)(f({variant:s}),a),...i})});m.displayName=d.bL.displayName,i.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(d.rc,{ref:t,className:(0,l.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...s})}).displayName=d.rc.displayName;let p=i.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(d.bm,{ref:t,className:(0,l.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...s,children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})});p.displayName=d.bm.displayName;let h=i.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(d.hE,{ref:t,className:(0,l.cn)("text-sm font-semibold",a),...s})});h.displayName=d.hE.displayName;let b=i.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(d.VY,{ref:t,className:(0,l.cn)("text-sm opacity-90",a),...s})});function g(){let{toasts:e}=(0,s.dj)();return(0,r.jsxs)(c,{children:[e.map(function(e){let{id:t,title:a,description:s,action:i,...d}=e;return(0,r.jsxs)(m,{...d,children:[(0,r.jsxs)("div",{className:"grid gap-1",children:[a&&(0,r.jsx)(h,{children:a}),s&&(0,r.jsx)(b,{children:s})]}),i,(0,r.jsx)(p,{})]},t)}),(0,r.jsx)(u,{})]})}b.displayName=d.VY.displayName},39972:(e,t,a)=>{"use strict";a.d(t,{Bx:()=>p,CG:()=>g,Gh:()=>b,SidebarProvider:()=>m,Yv:()=>v,useSidebar:()=>f,wZ:()=>x,x2:()=>h});var r=a(58081),s=a(82149),i=a(94063),d=a(43238),n=a(87687),o=a(5160),l=a(90229),c=a(55193);let u=s.createContext(null);function f(){let e=s.useContext(u);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e}let m=s.forwardRef((e,t)=>{let{defaultOpen:a=!0,open:i,onOpenChange:d,className:o,style:l,children:f,...m}=e,[p,h]=s.useState(!1),[b,g]=s.useState(!1);s.useEffect(()=>{let e=()=>{h(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let[v,x]=s.useState(a),w=null!=i?i:v,N=s.useCallback(e=>{let t="function"==typeof e?e(w):e;d?d(t):x(t),document.cookie="".concat("sidebar:state","=").concat(t,"; path=/; max-age=").concat(604800)},[d,w]),y=s.useCallback(()=>p?g(e=>!e):N(e=>!e),[p,N,g]);s.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),y())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[y]);let j=w?"expanded":"collapsed",_=s.useMemo(()=>({state:j,open:w,setOpen:N,isMobile:p,openMobile:b,setOpenMobile:g,toggleSidebar:y}),[j,w,N,p,b,g,y]);return(0,r.jsx)(u.Provider,{value:_,children:(0,r.jsx)(c.Bc,{delayDuration:0,children:(0,r.jsx)("div",{style:{"--sidebar-width":"280px","--sidebar-width-icon":"72px",...l},className:(0,n.cn)("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",o),ref:t,...m,children:f})})})});m.displayName="SidebarProvider";let p=s.forwardRef((e,t)=>{let{side:a="left",variant:s="sidebar",collapsible:i="icon",className:d,children:o,...c}=e,{isMobile:u,state:m,openMobile:p,setOpenMobile:h}=f();return"none"===i?(0,r.jsx)("div",{className:(0,n.cn)("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",d),ref:t,...c,children:o}):u?(0,r.jsx)(l.cj,{open:p,onOpenChange:h,...c,children:(0,r.jsx)(l.h,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"280px"},side:a,children:(0,r.jsx)("div",{className:"flex h-full w-full flex-col bg-white dark:bg-black",children:o})})}):(0,r.jsxs)("div",{ref:t,className:"group peer hidden md:block text-sidebar-foreground","data-state":m,"data-collapsible":"collapsed"===m?i:"","data-variant":s,"data-side":a,children:[(0,r.jsx)("div",{className:(0,n.cn)("duration-300 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-in-out","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===s||"inset"===s?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),(0,r.jsx)("div",{className:(0,n.cn)("duration-300 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-in-out md:flex","left"===a?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===s||"inset"===s?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",d),...c,children:(0,r.jsx)("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:o})})]})});p.displayName="Sidebar";let h=s.forwardRef((e,t)=>{let{className:a,onClick:s,...l}=e,{toggleSidebar:c,state:u,isMobile:m}=f();return(0,r.jsxs)(o.$,{ref:t,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:(0,n.cn)("h-9 w-9",a),onClick:e=>{null==s||s(e),c()},...l,children:["collapsed"!==u||m?(0,r.jsx)(d.A,{className:"h-5 w-5"}):(0,r.jsx)(i.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})});h.displayName="SidebarTrigger";let b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,"data-sidebar":"header",className:(0,n.cn)("flex flex-col gap-2 p-4",a),...s})});b.displayName="SidebarHeader";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,"data-sidebar":"footer",className:(0,n.cn)("flex flex-col gap-2 p-4",a),...s})});g.displayName="SidebarFooter";let v=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,"data-sidebar":"content",className:(0,n.cn)("flex min-h-0 flex-1 flex-col gap-2 overflow-auto p-2 group-data-[collapsible=icon]:overflow-hidden",a),...s})});v.displayName="SidebarContent";let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("nav",{ref:t,"data-sidebar":"nav",className:(0,n.cn)("grid items-start gap-1",a),...s})});x.displayName="SidebarNav",s.forwardRef((e,t)=>{let{className:a,active:s,icon:i,tooltip:d,children:o,...l}=e,{state:u,isMobile:m}=f(),p="collapsed"===u&&!m,h=(0,r.jsxs)("a",{ref:t,"data-sidebar":"nav-link","data-active":s,className:(0,n.cn)("group flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium transition-colors","hover:bg-accent hover:text-accent-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",s&&"bg-accent text-accent-foreground",a),...l,children:[i&&(0,r.jsx)("span",{className:"h-5 w-5 shrink-0",children:i}),!p&&(0,r.jsx)("span",{className:"truncate",children:o})]});return d&&p?(0,r.jsxs)(c.m_,{children:[(0,r.jsx)(c.k$,{asChild:!0,children:h}),(0,r.jsx)(c.ZI,{side:"right",align:"center",children:d})]}):h}).displayName="SidebarNavLink"},44503:(e,t,a)=>{"use strict";a.d(t,{I:()=>f,TwinProvider:()=>u});var r=a(58081),s=a(25027),i=a(19651),d=a(6437),n=a(82149),o=a(31240),l=a(68236);let c=(0,n.createContext)(void 0);function u(e){let{children:t}=e,{user:a}=(0,o.J)(),u=(0,i.useRouter)(),[f,m]=(0,n.useState)([]),[p,h]=(0,n.useState)([]),[b,g]=(0,n.useState)(!0),[v,x]=(0,n.useState)(!0),[w,N]=(0,n.useState)(null);(0,l.aj)();let y=(0,n.useCallback)(async()=>{x(!0);let e=await (0,s.KU)(u);h(await e.getAvailableTwins()),x(!1)},[u]),j=(0,n.useCallback)(async()=>{try{g(!0),N(null);let e=await (0,s.KU)(u),t=await e.getTwins();console.log("data",t),m(t)}catch(e){console.error("Error fetching twins:",e),N("Kh\xf4ng thể tải danh s\xe1ch Twin"),(0,d.hS)(e)}finally{g(!1)}},[u]);(0,n.useEffect)(()=>{a&&y()},[a,y]);let _=async()=>{await Promise.all([j()])};return(0,r.jsx)(c.Provider,{value:{twins:f,availableTwins:p,isLoading:b,isLoadingAvailable:v,error:w,getTwins:j,getTwinAvailable:y,getTwinById:e=>[...f,...p].find(t=>t._id===e||t.id===e),refreshTwins:_},children:t})}function f(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useTwin must be used within a TwinProvider");return e}},51168:(e,t,a)=>{"use strict";a.d(t,{ThemeProvider:()=>i});var r=a(58081);a(82149);var s=a(7135);function i(e){let{children:t,...a}=e;return(0,r.jsx)(s.N,{...a,children:t})}},55193:(e,t,a)=>{"use strict";a.d(t,{Bc:()=>n,ZI:()=>c,k$:()=>l,m_:()=>o});var r=a(58081),s=a(82149),i=a(96144),d=a(87687);let n=i.Kq,o=e=>(0,r.jsx)(i.bL,{delayDuration:100,...e}),l=i.l9,c=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...n}=e;return(0,r.jsx)(i.UC,{ref:t,sideOffset:s,className:(0,d.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})});c.displayName=i.UC.displayName},58700:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,6146,23)),Promise.resolve().then(a.bind(a,8933)),Promise.resolve().then(a.bind(a,51168)),Promise.resolve().then(a.bind(a,39972)),Promise.resolve().then(a.bind(a,34726)),Promise.resolve().then(a.bind(a,78577)),Promise.resolve().then(a.bind(a,44503)),Promise.resolve().then(a.bind(a,31240)),Promise.resolve().then(a.t.bind(a,64905,23))},90229:(e,t,a)=>{"use strict";a.d(t,{CG:()=>c,Fm:()=>h,Qs:()=>g,cj:()=>l,h:()=>p,qp:()=>b});var r=a(58081),s=a(82149),i=a(92500),d=a(23484),n=a(22522),o=a(87687);let l=i.bL,c=i.l9;i.bm;let u=i.ZL,f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});f.displayName=i.hJ.displayName;let m=(0,d.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),p=s.forwardRef((e,t)=>{let{side:a="right",className:s,children:d,...l}=e;return(0,r.jsxs)(u,{children:[(0,r.jsx)(f,{}),(0,r.jsxs)(i.UC,{ref:t,className:(0,o.cn)(m({side:a}),s),...l,children:[d,(0,r.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});p.displayName=i.UC.displayName;let h=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};h.displayName="SheetHeader";let b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold text-foreground",a),...s})});b.displayName=i.hE.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...s})});g.displayName=i.VY.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[2979,5206,1144,5331,8377,9837,2500,8101,9423,2741,5027,5721,8577,497,954,7358],()=>t(58700)),_N_E=e.O()}]);